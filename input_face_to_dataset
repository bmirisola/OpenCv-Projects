import cv2
import Constants
import time
import os
import math

cap = cv2.VideoCapture(0)
cap.set(3, 640) # set video width
cap.set(4, 480) # set video height

# For each person, enter one face id
face_id = input('\n enter user id and press <return> ==>  ')
print("\n [INFO] Initializing face capture. Look at the camera and wait ...")
path = "dataset/"+str(face_id)+ "/"
if not os.path.exists(path):
    os.mkdir("dataset/"+str(face_id))
time.sleep(2)
hasGottenTime = False
oldTime = 0

# Initialize individual sampling face count
count = 0

while(True):
    ret, frame = cap.read()
    if(not hasGottenTime):
        oldTime = time.time()
        hasGottenTime = True
        # Save the captured image into the datasets folder
    newTime = time.time()
    if math.fabs(newTime-oldTime) >= Constants.SAMPLE_RATE:
        cv2.imwrite(path + str(face_id) + '.' + str(count+1) + ".jpg", frame)
        count += 1
        hasGottenTime = False
        print ("Taken Sample!!!")
    cv2.imshow('frame', frame)
    k = cv2.waitKey(100) & 0xff # Press 'ESC' for exiting video
    if k == ord('q'):
        break
    elif count >= Constants.NUMBER_OF_DATA_SAMPLES: # Take 100 face sample and stop video
         break

# Do a bit of cleanup
print("\n [INFO] Exiting Program and cleanup stuff")
cap.release()
cv2.destroyAllWindows()